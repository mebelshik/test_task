---
- name: Clone repository and build Docker container with nginx
  hosts: localhost
  become: yes
  vars:
    ansible_python_interpreter: /usr/bin/python3
    project_src: /path/to/your/project
  tasks:
    - name: Clone the repository
      git:
        repo: 'https://github.com/mebelshik/test_task.git'
        dest: "{{ project_src }}"
        version: main

    - name: Build and run the Docker container
      docker_compose:
        build: yes
        state: present
        definition:
          version: '3'
          services:
            nginx:
              image: nginx
              ports:
                - "80:80"
              volumes:
                - /proc:/host_proc:ro
              command: "sh -c 'echo \"CPU cores: \"; nproc; echo \"Memory: \"; free -h; echo \"Disk space: \"; df -h'"
